<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/"  xmlns:date="http://www.thymeleaf.org/" lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comments</title>
  <style th:insert="fragments/style">
  </style>
  <style>
    .searchForm{
      display: flex;
      flex-direction: row;
      align-items: flex-start;
      justify-content: space-evenly;
      width: max-content;
      padding: 25px;
    }
    form{
      display: flex;
      width: fit-content;
      height: fit-content;
      padding: 25px;
      align-items: center;
      justify-content: center;
    }
    .dates{
      display: flex;
      width: 100%;
      align-content: center;
      justify-content: center;
      align-self: center;
      justify-self: center;
      border: none ;
    }
    table{
      display: table;
      width: 100%;
      height: max-content;
      justify-content: space-evenly;
      justify-items: center;
      align-content: space-evenly;
      align-items: center;
      border: gray 2px solid;
    }
    .searchBox{
      margin-left: 25px;
      margin-right: 25px;
    }
    .searchLabel{
      padding-left: 10px;
      padding-right: 10px;
    }
    .mainTable{
      display: flex;
      width: max-content;
      height: max-content;
      justify-content: space-evenly;
      border: black 5px;
    }
    tr{
      display: flex;
      height: 100%;
      justify-content: space-evenly;
      align-content: center;
      width: 100%;
      border: black 1px solid;
    }
    td{
      display: flex;

      width: 100%;
      height: max-content;
      justify-content: space-evenly;
      justify-self: center;
      align-content: center;
      align-self: center;
    }
  </style>
</head>
<body>
<form th:action="@{/web/schedules/}" class = "searchForm">
  <label for="city" class="searchLabel">City</label>
  <input type="text" id="city" name="city" class = "searchBox"/><br/>
  <label for="title" class="searchLabel">Movie Title</label>
  <input type="text" id="title" name="title" class = "searchBox"/><br/>
  <label for="date" class="searchLabel">Date</label>
  <input type="date" id="date" name="date" th:value="${todaysDate} "class = "searchBox"/><br/>
  <button role="button" type="submit" class="searchLabel"><a>Search</a></button>
</form>
<div class = "mainTable">
<table>
<thead class="dates"><tr><th>Dates</th></tr></thead>
  <tr th:each="day,iter : ${days}"><td>
  <table>
    <thead>
    <tr>  <th> <td th:text="${dates[iter.index]}" style="border: none"></td></th></tr>
    <tr>
      <th>Theatre</th>
      <th>Movie Title</th>
      <th>Rating</th>
      <th>Run Time</th>
      <th>Start Times</th>
      <th></th>
    </tr>
    </thead>
    <th:block th:each="schedule,iteration1 : ${schedules}" th:if="${schedule.getDay().getDayOfYear()}==${day}">
      <tr th:each="showing,iteration :${schedule.showings}">
      <td th:text="${showing.theatre.location.address.zipcode} + ' ' + ${showing.theatre.location.address.city}"></td>
      <td th:text="${showing.movie.title}"></td>
      <td th:text="${showing.movie.rated}"></td>
      <td th:text="${showing.movie.runtime} + ' mins'"></td>
      <td th:text="${showing.startTimeString}"></td>
        <td ><a th:href="@{/web/schedules/edit/{id}/{showingId}(id=${schedule.id},showingId=${iteration.index})}">Edit</a></td>
    </tr>
    </th:block>
    <button th:href="@{/web/delete/schedule/{id}(id=${schedules.get(iter.index).getId()})}">Delete This Date</button>
  </table>
  </td></tr>
</table>
</div>
</body>
</html>